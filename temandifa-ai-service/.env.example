# TemanDifa AI Service Configuration

# =============================================================================
# App Settings
# =============================================================================
APP_NAME=TemanDifa AI Service
APP_VERSION=1.0.0
DEBUG=false

# =============================================================================
# Model Settings
# =============================================================================
YOLO_MODEL=models/yolov8n.pt
YOLO_DEVICE=auto  # "auto", "cpu", "cuda", or "mps"
WHISPER_DEVICE=auto # "auto", "cpu", "cuda", or "mps"
WHISPER_MODEL=base  # Options: tiny, base, small, medium, large
OCR_DEFAULT_LANG=en

# =============================================================================
# File Limits (in bytes)
# =============================================================================
MAX_IMAGE_SIZE=10485760  # 10MB
MAX_AUDIO_SIZE=26214400  # 25MB

# =============================================================================
# Image Preprocessing
# Automatically resize large images to save memory
# =============================================================================
MAX_IMAGE_DIMENSION=1920  # Max width/height in pixels
IMAGE_QUALITY=85  # JPEG compression quality (1-100)

# =============================================================================
# Request Timeout
# Maximum time for processing a single request
# =============================================================================
REQUEST_TIMEOUT=120  # seconds

# =============================================================================
# Batch Processing
# Settings for /detect/batch and /ocr/batch endpoints
# =============================================================================
MAX_BATCH_SIZE=10  # Maximum files per batch request

# =============================================================================
# Rate Limiting
# =============================================================================
RATE_LIMIT_REQUESTS=10
RATE_LIMIT_WINDOW=1 minute

# =============================================================================
# Concurrency & Resources
# Control thread pool size for AI inference
# =============================================================================
# Default: number of CPU cores (dynamic). Set explicit value to override.
AI_WORKER_THREADS=2
TEMP_FILE_CLEANUP_DELAY=0.5  # Time to wait (in seconds) before cleaning up temp files

# =============================================================================
# Logging
# =============================================================================
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR
LOG_FORMAT=text  # "text" for dev, "json" for production

# =============================================================================
# Metrics & Monitoring
# Prometheus metrics endpoint at /metrics
# =============================================================================
ENABLE_METRICS=true

# =============================================================================
# Model Warm-up
# Retry configuration for model loading at startup
# =============================================================================
WARMUP_MAX_RETRIES=3
WARMUP_RETRY_DELAY=2.0  # seconds between retries

# =============================================================================
# Optimization Flags
# =============================================================================
ENABLE_ONNX=false
ENABLE_SMART_FALLBACK=true

# =============================================================================
# API Key Authentication (Optional)
# Enable for direct access to AI service
# When enabled, requests must include X-API-Key header
# =============================================================================
API_KEY_ENABLED=false
API_KEY=your-secret-api-key-here
GEMINI_API_KEY=your-google-gemini-api-key

# =============================================================================
# Redis Caching (Optional)
# Enable to cache AI inference results
# Significantly reduces latency for duplicate requests
# =============================================================================
REDIS_URL=redis://localhost:6379
CACHE_TTL_DETECTION=3600      # 1 hour for object detection
CACHE_TTL_OCR=7200            # 2 hours for OCR
CACHE_TTL_TRANSCRIPTION=1800  # 30 minutes for transcription
